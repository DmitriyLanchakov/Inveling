# Encoder
network.add(nn.LSTM(4708, 227, 227))
network.add(nn.LSTM(227, 227, 227))
network.add(nn.LSTM(227, 227, 227))
network.add(nn.LSTM(227, 227, 227 * 3))
# Decoder
network.add(nn.Reshape((1, 3, 227, 227)))
network.add(nn.SpatialConvolution((1, 3, 227, 227), (96, 3, 11, 11)))
network.add(nn.ReLU())
network.add(nn.SpatialMaxPooling((3, 3), 72))
network.add(nn.SpatialConvolution((1, 96, 72, 72), (256, 96, 5, 5)))
network.add(nn.ReLU())
network.add(nn.SpatialMaxPooling((3, 3), 22))
network.add(nn.SpatialConvolution((1, 256, 22, 22), (384, 256, 3, 3)))
network.add(nn.ReLU())
network.add(nn.SpatialMaxPooling((1, 1), 20))
network.add(nn.SpatialConvolution((1, 384, 20, 20), (384, 384, 3, 3)))
network.add(nn.ReLU())
network.add(nn.SpatialMaxPooling((1, 1), 18))
network.add(nn.SpatialConvolution((1, 384, 18, 18), (256, 384, 3, 3)))
network.add(nn.ReLU())
network.add(nn.SpatialMaxPooling((3, 3), 5))
network.add(nn.Dropout(0.5))
network.add(nn.Reshape((6400,)))
network.add(nn.Linear(6400, 30000))
network.add(nn.Reshape((3*100, 100)))
network.add(nn.MSE(), cost=True)
