network.add(nn.SpatialConvolution((1, 3, 400, 400), (64, 3, 3, 3)))
network.add(nn.ReLU())
network.add(nn.SpatialConvolution((1, 64, 398, 398), (64, 64, 3, 3)))
network.add(nn.ReLU())
network.add(nn.SpatialMaxPooling((2, 2)))
network.add(nn.Dropout(0.25))

network.add(nn.SpatialConvolution((1, 64, 198, 198), (128, 64, 3, 3)))
network.add(nn.ReLU())
network.add(nn.SpatialConvolution((1, 128, 196, 196), (256, 128, 3, 3)))
network.add(nn.ReLU())
network.add(nn.SpatialConvolution((1, 256, 194, 194), (256, 256, 3, 3)))
network.add(nn.ReLU())
network.add(nn.SpatialConvolution((1, 256, 192, 192), (256, 256, 3, 3)))
network.add(nn.ReLU())
network.add(nn.SpatialMaxPooling((2, 2)))
network.add(nn.Dropout(0.25))

network.add(nn.SpatialConvolution((1, 256, 95, 95), (1024, 256, 3, 1)))
network.add(nn.ReLU())
network.add(nn.Dropout(0.5))
network.add(nn.SpatialConvolution((1, 1024, 93, 95), (1024, 1024, 1, 1)))
network.add(nn.ReLU())
network.add(nn.SpatialMaxPooling((2, 2)))
network.add(nn.SpatialMaxPooling((2, 2)))
network.add(nn.Dropout(0.5))

network.add(nn.Linear(541696, 450000))
network.add(nn.Reshape(3, 500, 300))
